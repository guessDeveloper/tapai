var __reflect=this&&this.__reflect||function(e,t,i){e.__class__=t,i?i.push(t):i=[t],e.__types__=e.__types__?i.concat(e.__types__):i},__extends=this&&this.__extends||function(e,t){function i(){this.constructor=e}for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r]);i.prototype=t.prototype,e.prototype=new i},__awaiter=this&&this.__awaiter||function(e,t,i,r){return new(i||(i=Promise))(function(a,s){function h(e){try{o(r.next(e))}catch(t){s(t)}}function n(e){try{o(r["throw"](e))}catch(t){s(t)}}function o(e){e.done?a(e.value):new i(function(t){t(e.value)}).then(h,n)}o((r=r.apply(e,t||[])).next())})},__generator=this&&this.__generator||function(e,t){function i(e){return function(t){return r([e,t])}}function r(i){if(a)throw new TypeError("Generator is already executing.");for(;o;)try{if(a=1,s&&(h=s[2&i[0]?"return":i[0]?"throw":"next"])&&!(h=h.call(s,i[1])).done)return h;switch(s=0,h&&(i=[0,h.value]),i[0]){case 0:case 1:h=i;break;case 4:return o.label++,{value:i[1],done:!1};case 5:o.label++,s=i[1],i=[0];continue;case 7:i=o.ops.pop(),o.trys.pop();continue;default:if(h=o.trys,!(h=h.length>0&&h[h.length-1])&&(6===i[0]||2===i[0])){o=0;continue}if(3===i[0]&&(!h||i[1]>h[0]&&i[1]<h[3])){o.label=i[1];break}if(6===i[0]&&o.label<h[1]){o.label=h[1],h=i;break}if(h&&o.label<h[2]){o.label=h[2],o.ops.push(i);break}h[2]&&o.ops.pop(),o.trys.pop();continue}i=t.call(e,o)}catch(r){i=[6,r],s=0}finally{a=h=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}var a,s,h,n,o={label:0,sent:function(){if(1&h[0])throw h[1];return h[1]},trys:[],ops:[]};return n={next:i(0),"throw":i(1),"return":i(2)},"function"==typeof Symbol&&(n[Symbol.iterator]=function(){return this}),n},Scene=function(e){function t(){var t=e.call(this)||this;return t.addEventListener(eui.UIEvent.COMPLETE,t.onComplete,t),t}return __extends(t,e),t}(eui.Component);__reflect(Scene.prototype,"Scene");var AssetAdapter=function(){function e(){}return e.prototype.getAsset=function(e,t,i){function r(r){t.call(i,r,e)}if(RES.hasRes(e)){var a=RES.getRes(e);a?r(a):RES.getResAsync(e,r,this)}else RES.getResByUrl(e,r,this,RES.ResourceItem.TYPE_IMAGE)},e}();__reflect(AssetAdapter.prototype,"AssetAdapter",["eui.IAssetAdapter"]);var LoadingUI=function(e){function t(t){var i=e.call(this)||this;return i.createView(),i.callback=t,i}return __extends(t,e),t.prototype.createView=function(){this.title=new eui.Label,this.title.width=750,this.title.height=200,this.title.x=0,this.title.y=260,this.title.text="Cardigory",this.title.size=95,this.title.textAlign="center",this.addChild(this.title),this.textField=new egret.TextField,this.addChild(this.textField),this.textField.y=682,this.textField.width=750,this.textField.size=30,this.textField.textAlign="center",this.percentBg=new egret.Shape,this.percentBg.graphics.beginFill(268435455,.2),this.percentBg.graphics.drawRect(0,0,480,6),this.percentBg.graphics.endFill(),this.percentBg.x=135,this.percentBg.y=732,this.percent=new egret.Shape,this.percent.graphics.beginFill(268435455,1),this.percent.graphics.drawRect(0,0,0,6),this.percent.graphics.endFill(),this.percent.x=135,this.percent.y=732,this.addChild(this.percentBg)},t.prototype.onProgress=function(e,t){var i=Math.floor(e/t*100),r=i/100*480;this.textField.text=i+"%",this.percent.graphics.clear(),this.percent.graphics.beginFill(268435455,1),this.percent.graphics.drawRect(0,0,r,6),this.percent.graphics.endFill(),this.addChild(this.percent),100==i&&this.complate()},t.prototype.complate=function(){var e=this;this.removeChild(this.percent),this.removeChild(this.percentBg),this.removeChild(this.textField);var t=new eui.Group;t.width=580,t.height=110,t.touchEnabled=!0,t.x=85,t.y=1084;var i=new egret.Shape;i.graphics.beginFill(51584,1),i.graphics.drawRect(0,0,580,110),i.graphics.endFill(),t.addChild(i);var r=new eui.Label;r.text="开始",r.width=580,r.height=110,r.textAlign="center",r.verticalAlign="middle",r.size=40,r.textColor=16777215,t.addChild(r),this.addChild(t),t.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){e.callback()},this)},t}(egret.Sprite);__reflect(LoadingUI.prototype,"LoadingUI",["RES.PromiseTaskReporter"]);var Main=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.root="/",t.circle=new egret.Shape,t.speed=50,t.version=0,t.UA=window.navigator.userAgent,t.IsAndroid=/Android|HTC/i.test(t.UA)||(window.navigator.platform+"").match(/Linux/i),t.IsIPad=!t.IsAndroid&&/iPad/i.test(t.UA),t.IsIPhone=!t.IsAndroid&&/iPod|iPhone/i.test(t.UA),t.IsIOS=t.IsIPad||t.IsIPhone,t.IsWeixin=/MicroMessenger/i.test(t.UA),t.IsMiniProgram=/miniProgram/i.test(t.UA),t.IsWeibo=/weibo/i.test(t.UA),t.isTouch=!1,t.cardPosition={one:{x:30,y:277,width:153,height:272},two:{x:209,y:277,width:153,height:272},three:{x:388,y:277,width:153,height:272},four:{x:567,y:277,width:153,height:272},answer:{x:299,y:845,width:153,height:272}},t}return __extends(t,e),t.prototype.createChildren=function(){e.prototype.createChildren.call(this),egret.lifecycle.addLifecycleListener(function(e){}),egret.lifecycle.onPause=function(){egret.ticker.pause(),console.log("切换")},egret.lifecycle.onResume=function(){egret.ticker.resume(),console.log("切换")};var t=new AssetAdapter;egret.registerImplementation("eui.IAssetAdapter",t),egret.registerImplementation("eui.IThemeAdapter",new ThemeAdapter),this.runGame()["catch"](function(e){console.log(e)})},t.prototype.runGame=function(){return __awaiter(this,void 0,void 0,function(){var e,t;return __generator(this,function(i){switch(i.label){case 0:return[4,this.loadResource()];case 1:return i.sent(),[4,RES.getResAsync("description_json")];case 2:return e=i.sent(),[4,platform.login()];case 3:return i.sent(),[4,platform.getUserInfo()];case 4:return t=i.sent(),console.log(t),[2]}})})},t.prototype.loadResource=function(){return __awaiter(this,void 0,void 0,function(){var e,t,i;return __generator(this,function(r){switch(r.label){case 0:e=this,r.label=1;case 1:return r.trys.push([1,5,,6]),t=new LoadingUI(function(){this.stage.removeChild(t),e.createGameScene()}),this.stage.addChild(t),[4,RES.loadConfig("resource/default.res.json","resource/")];case 2:return r.sent(),[4,this.loadTheme()];case 3:return r.sent(),[4,RES.loadGroup("preload",0,t)];case 4:return r.sent(),[3,6];case 5:return i=r.sent(),console.error(i),[3,6];case 6:return[2]}})})},t.prototype.loadTheme=function(){var e=this;return new Promise(function(t,i){var r=new eui.Theme("resource/default.thm.json",e.stage);r.addEventListener(eui.UIEvent.COMPLETE,function(){t()},e)})},t.prototype.CreatePersonMessage=function(){var e=this,t=new eui.Label;t.text="请填写以下信息",t.textAlign="center",t.size=40,t.width=750,t.y=185,this.addChild(t);var i=new eui.Label;i.size=24,i.text="性别*",i.textColor=16777215,i.width=200,i.x=85,i.y=329,this.addChild(i);var r=this.radioPart("男");r.x=85,r.y=377,this.addChild(r);var a=this.radioPart("女");a.y=377,a.x=411,this.addChild(a);var s=new egret.Shape;s.graphics.beginFill(16777215),s.graphics.drawCircle(98,410,11),s.graphics.endFill(),this.addChild(s),s.blendMode=egret.BlendMode.ERASE;var h=new egret.Shape;h.graphics.beginFill(16777215),h.graphics.drawCircle(98,410,5.5),h.graphics.endFill(),h.alpha=0,this.addChild(h);var n=new egret.Shape;n.graphics.beginFill(16777215),n.graphics.drawCircle(424,410,11),n.graphics.endFill(),this.addChild(n),n.blendMode=egret.BlendMode.ERASE;var o=new egret.Shape;o.graphics.beginFill(16777215),o.graphics.drawCircle(424,410,5.5),o.graphics.endFill(),o.alpha=0,this.addChild(o),r.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){egret.Tween.get(r).to({alpha:1},100),s.alpha=0,h.alpha=1,e.choseSex=0,r.getChildByName("circle").alpha=.4,egret.Tween.get(a).to({alpha:.4},100),n.alpha=1,o.alpha=0,a.getChildByName("circle").alpha=1,y.alpha=0},this),a.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){egret.Tween.get(r).to({alpha:.4},100),s.alpha=1,h.alpha=0,e.choseSex=1,r.getChildByName("circle").alpha=1,egret.Tween.get(a).to({alpha:1},100),n.alpha=0,o.alpha=1,a.getChildByName("circle").alpha=.4,y.alpha=0},this);var d=new eui.Label;d.size=24,d.text="年龄*",d.textColor=16777215,d.width=200,d.x=85,d.y=514,this.addChild(d);var g=this.createInput("请输入您的年龄");g.inputType=egret.TextFieldInputType.TEL,g.x=85,g.y=561,g.alpha=.4,this.addChild(g);var l=new egret.Shape;l.graphics.beginFill(16777215),l.graphics.drawRect(0,0,580,2),l.graphics.endFill(),l.x=85,l.y=628,l.alpha=.4,this.addChild(l),g.addEventListener(egret.Event.FOCUS_IN,function(){console.log("输入"),"请输入您的年龄"==g.text&&(g.text=""),g.size=28,g.height=70,g.verticalAlign="middle",egret.Tween.get(l).to({alpha:1},300)},this),g.addEventListener(egret.Event.FOCUS_OUT,function(){""==g.text&&(g.text="请输入您的年龄"),v.alpha=0,egret.Tween.get(l).to({alpha:.4},300)},this);var c=new eui.Label;c.size=24,c.text="邮箱*",c.textColor=16777215,c.width=200,c.x=85,c.y=700,this.addChild(c);var p=this.createInput("请输入您的邮箱");p.x=85,p.y=747,p.alpha=.4,this.addChild(p);var u=new egret.Shape;u.graphics.beginFill(16777215),u.graphics.drawRect(0,0,580,2),u.graphics.endFill(),u.x=85,u.y=814,u.alpha=.4,this.addChild(u),p.addEventListener(egret.Event.FOCUS_IN,function(){console.log("输入"),"请输入您的邮箱"==p.text&&(p.text=""),p.size=28,p.height=70,p.verticalAlign="middle",egret.Tween.get(u).to({alpha:1},300)},this),p.addEventListener(egret.Event.FOCUS_OUT,function(){""==p.text&&(p.text="请输入您的邮箱"),x.alpha=0,egret.Tween.get(u).to({alpha:.4},300)},this);var w=new eui.Group;w.width=580,w.height=110,w.x=85,w.y=1084;var C=new egret.Shape;C.graphics.beginFill(51584),C.graphics.drawRect(0,0,580,110),C.graphics.endFill(),w.addChild(C);var T=new eui.Label;T.width=580,T.height=110,T.text="提交",T.size=40,T.textColor=16777215,T.textAlign="center",T.verticalAlign="middle",w.addChild(T),this.addChild(w);var y=new eui.Label;y.text="*请选择性别",y.size=20,y.textColor=16187136,y.width=580,y.x=85,y.y=457,y.alpha=0,this.addChild(y);var v=new eui.Label;v.text="*请输入有效年龄，如：25",v.size=20,v.textColor=16187136,v.width=580,v.x=85,v.y=642,v.alpha=0,this.addChild(v);var x=new eui.Label;x.text="*请输入完整、有效的邮箱地址",x.size=20,x.textColor=16187136,x.width=580,x.x=85,x.y=826,x.alpha=0,this.addChild(x),w.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){if(void 0==this.choseSex)y.alpha=1;else if(/[2-5][0-9]|60|19|18/.test(g.text))if(/^[a-zA-Z0-9_.-]+@[a-zA-Z0-9]+(\.[a-zA-Z0-9-]+)*\.[a-zA-Z0-9]{2,6}$/.test(p.text)){y.alpha=0,v.alpha=0,x.alpha=0;var t={playerAge:g.text,playerSex:e.choseSex,playerEmail:p.text};this.Http("POST",this.root+"WcstGame/loginGame.do",t,function(t){var s=t.currentTarget,h=JSON.parse(s.response);0==h.status?(e.removeChild(i),e.removeChild(r),e.removeChild(a),e.removeChild(x),e.removeChild(c),e.removeChild(p),e.removeChild(u),e.removeChild(v),e.removeChild(d),e.removeChild(g),e.removeChild(l),e.removeChild(y),e.removeChild(w),e.init()):1==h.parameterType?(y.text=h.message,y.alpha=1):2==h.parameterType?(v.text=h.message,v.alpha=1):(x.text=h.message,x.alpha=1)},function(e){var t=e.currentTarget,i=JSON.parse(t.response);alert(i.message)})}else y.alpha=0,v.alpha=0,x.alpha=1;else y.alpha=0,v.alpha=1},this)},t.prototype.sexSelect=function(e){var t=e.target;console.log(t)},t.prototype.radioPart=function(e){var t=new eui.Group;t.width=258,t.height=70,t.alpha=.4;var i=new egret.Shape;i.graphics.beginFill(16777215),i.graphics.drawArc(13,33,13,0,2*Math.PI,!0),i.graphics.endFill(),i.name="circle",t.addChild(i);var r=new eui.Label;r.text=e,r.textColor=16777215,r.size=28,r.width=230,r.height=68,r.x=40,r.verticalAlign="middle",t.addChild(r);var a=new egret.Shape;return a.graphics.beginFill(16777215),a.graphics.drawRect(0,68,258,2),a.graphics.endFill(),t.addChild(a),t},t.prototype.createInput=function(e){var t=new egret.TextField;return t.type=egret.TextFieldType.INPUT,t.width=580,t.height=68,t.textColor=16777215,t.size=28,t.text=e,t.touchEnabled=!0,t.verticalAlign="middle",t},t.prototype.createGameScene=function(){this.CreatePersonMessage()},t.prototype.init=function(){document.body.style.background="#29748D";var e=this.stage.stageWidth,t=this.stage.stageHeight,i=new egret.Shape;i.graphics.beginFill(2716813,1),i.graphics.drawRect(0,0,e,t),i.graphics.endFill(),i.x=0,i.y=0,this.addChild(i);var r=new egret.Shape;r.graphics.beginFill(16777215,.3),r.graphics.drawArc(53,73,23,0,2*Math.PI,!1),r.graphics.endFill(),this.addChild(r);this.timer(3e4,this.circle);this.score=new egret.TextField,this.score.y=54,this.score.text="0",this.score.size=40,this.score.width=720,this.score.textAlign="right",this.score.fontFamily="MyText",this.score.alpha=0,this.addChild(this.score),this.png34=this.createBitmapByName("34_png"),this.png34.width=55,this.png34.height=24,this.png34.x=666,this.png34.y=62,this.addChild(this.png34);var a=this.createBitmapByName("line_bg_png");a.width=689,a.height=30,a.x=30,a.y=705,this.addChild(a);var s=this.cardPosition.one;this.cardSelectBg=new egret.Shape,this.cardSelectBg.graphics.beginFill(16777215),this.cardSelectBg.graphics.drawRect(0,0,s.width+8,s.height+8),this.cardSelectBg.graphics.endFill(),this.cardSelectBg.alpha=0,this.addChild(this.cardSelectBg),this.CreateHelpBtn(),this.cardBg1=this.createCardBg("one"),this.cardBg2=this.createCardBg("two"),this.cardBg3=this.createCardBg("three"),this.cardBg4=this.createCardBg("four"),this.Card1=this.createCard("AAA","one"),this.Card2=this.createCard("BBB","two"),this.Card3=this.createCard("CCC","three"),this.Card4=this.createCard("DDD","four"),this.dragObjectInit("AAA"),this.steps()},t.prototype.timer=function(e,t){var i=this;t.graphics.beginFill(16777215,1),t.graphics.drawArc(0,0,23,0,2*Math.PI,!0),t.graphics.endFill(),t.width=46,t.height=46,t.anchorOffsetX=-23,t.anchorOffsetY=-23,t.x=30,t.y=96,egret.Tween.get(t).to({rotation:-90}),this.addChild(t);var r=new egret.Timer(this.speed,e/this.speed);return this.limitTime=e,this.nowTime=e,r.addEventListener(egret.TimerEvent.TIMER,function(){i.drawTime(t)},this),r.addEventListener(egret.TimerEvent.TIMER_COMPLETE,i.endTime,this),r},t.prototype.drawTime=function(e){console.log("定时器在运作"),this.nowTime-=this.speed;var t=2*Math.PI-this.nowTime/this.limitTime*2*Math.PI;e.graphics.clear(),e.graphics.beginFill(16777215,1),e.graphics.moveTo(0,0),e.graphics.lineTo(23,0),e.graphics.drawArc(0,0,23,0,t,this.nowTime>0),e.graphics.lineTo(0,0),e.graphics.endFill(),this.addChild(e),this.isHelpbtnOpen&&this.setChildIndex(e,8)},t.prototype.endTime=function(){var e=this,t={singleCardValue:"",unqiueCardValue:e.anwserCardType,remainingTime:Math.floor(e.nowTime/1e3),currentScore:e.score.text,isExistGame:0};e.sendAnser(t)},t.prototype.createBitmapByName=function(e){var t=new egret.Bitmap,i=RES.getRes(e);return t.texture=i,t},t.prototype.onButtonClick=function(e){var t=this;this.dragRemoveevent(),this.isHelpbtnOpen=!0,this.helpBtn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onButtonClick,this);var i=new egret.Shape;i.graphics.beginFill(0,.75),i.graphics.drawRect(0,0,750,1334),i.graphics.endFill(),i.graphics.beginFill(16777215,1),this.shadowBg=i,this.addChild(i),this.BigBgShow(),this.setChildIndex(this.shadowBg,1e3);var r=new eui.Group;r.x=100,r.y=393,r.width=575,r.height=450,this.addChild(r);var a=new eui.Label;a.text="帮助",a.width=549,a.size=36,a.textColor=16777215,a.x=100,a.y=312,a.textAlign="center",this.addChild(a);var s=new eui.Label;s.width=575,s.height=900,s.y=10,s.textColor=10066329,s.size=26,s.lineSpacing=12,this.addChild(s),r.addChild(s),s.textFlow=(new egret.HtmlTextParser).parser('<font color="#999999" size="28" ><b>请注意，在您阅读时，游戏倒计时并未暂停。</b></font>\n\n<font color="#999999" size="28" >游戏过程中不可暂停。如果退出，您的回答将不会被记录，并且将会从首页重新开始。</font>\n\n<font color="#999999" size="28" style="letter-spacing:10;">为了您的体验，请尽量在安静、不被打扰的环境下一次性地完成本游戏。\n\n如果您因为某些原因无法继续游戏，请关闭浏览器页面并重新开始。\n\n我们会在保证游戏有效性的前提下收集尽量少的信息。\n\n我们将采取合理的安全手段保护游戏使用及分发过程中收集的所有信息。\n\n在没有您的许可的情况下，我们不会向任何无关的第三方提供任何有可能识别出您的身份的信息。</font>\n\n<font color="#999999" size="27">如果对游戏有任何的建议或者疑问 ，     请联系\nh9000cn@outlook.com</font>'),r.addChild(s);var h=new eui.Scroller;h.x=100,h.y=393,h.width=575,h.height=450,h.viewport=r,this.addChild(h),h.verticalScrollBar.visible=!0;var n=this.createBitmapByName("close_png");n.width=52,n.height=52,n.x=349,n.y=1062,n.touchEnabled=!0,this.addChild(n),n.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){r.removeChild(s),t.removeChild(h),t.removeChild(n),t.helpBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onButtonClick,this),t.removeChild(t.shadowBg),t.BigBgHide(),t.isHelpbtnOpen=!1,t.removeChild(a),t.touchHandles(),t.setChildIndex(t.dragCardLinght,t.numChildren),t.setChildIndex(t.dragCardBg,t.numChildren),t.setChildIndex(t.dragGroup,t.numChildren)},this)},t.prototype.dragObjectInit=function(e){this.stage.stageWidth,this.stage.stageHeight;this.dragCardLinght=new egret.Shape,this.dragCardLinght.graphics.beginFill(11913514,1),this.dragCardLinght.graphics.drawRoundRect(0,0,167,286,10,10),this.dragCardLinght.graphics.endFill(),this.dragCardLinght.x=this.cardPosition.answer.x-7,this.dragCardLinght.y=this.cardPosition.answer.y-7,this.dragCardLinght.alpha=0;var t=new egret.BlurFilter(3,3);this.dragCardLinght.filters=[t],this.dragCardBg=new eui.ViewStack,this.dragCardBg.width=this.cardPosition.answer.width,this.dragCardBg.width=this.cardPosition.answer.height,this.dragCardBg.x=this.cardPosition.answer.x,this.dragCardBg.y=this.cardPosition.answer.y;var i=this.createCardBg("answer");i.x=0,i.y=0;var r=new egret.Shape;r.graphics.beginFill(0,1),r.graphics.drawRect(0,0,this.cardPosition.answer.width,this.cardPosition.answer.height),r.graphics.endFill(),this.dragCardBg.addChild(i),this.dragCardBg.addChild(r),this.dragCardBg.selectedIndex=0,this.dragGroup=this.createCard(e,"answer"),this.dragGroup.touchEnabled=!0,this.addChild(this.dragCardLinght),this.addChild(this.dragCardBg),this.addChild(this.dragGroup),this.isHelpbtnOpen&&(this.setChildIndex(this.dragCardLinght,10),this.setChildIndex(this.dragCardBg,11),this.setChildIndex(this.dragGroup,12))},t.prototype.touchHandles=function(){this.dragGroup.addEventListener(egret.TouchEvent.TOUCH_BEGIN,this.OntouchBegin,this),this.dragGroup.addEventListener(egret.TouchEvent.TOUCH_END,this.Ontouchend,this)},t.prototype.OntouchBegin=function(e){this.isTouch=!0,this.startX=this.dragGroup.x,this.startY=this.dragGroup.y,this.XTouch=e.stageX,this.YTouch=e.stageY,this.stage.addEventListener(egret.TouchEvent.TOUCH_MOVE,this.OntouchMove,this)},t.prototype.OntouchMove=function(e){if(1==this.isTouch){this.dragCardLinght.x=this.startX+(e.stageX-this.XTouch)-7,this.dragCardLinght.y=this.startY+(e.stageY-this.YTouch)-7,this.dragCardBg.x=this.startX+(e.stageX-this.XTouch),this.dragCardBg.y=this.startY+(e.stageY-this.YTouch),this.dragGroup.x=this.startX+(e.stageX-this.XTouch),this.dragGroup.y=this.startY+(e.stageY-this.YTouch);var t=!1;for(var i in this.cardPosition)if(this.hitTest(this.cardPosition[i])&&"answer"!=i){t=!0,this.cardSelectBg.x=this.cardPosition[i].x-4,this.cardSelectBg.y=this.cardPosition[i].y-4,this.cardSelectBg.alpha=1;break}t||(this.cardSelectBg.alpha=0)}},t.prototype.Ontouchend=function(e){this.isTouch=!1,this.stage.removeEventListener(egret.TouchEvent.TOUCH_MOVE,this.OntouchMove,this);var t=!1,i=this;this.cardSelectBg.alpha=0;var r=function(e){if(a.hitTest(a.cardPosition[e])&&"answer"!=e){t=!0,a.dragRemoveevent(),a.startTimer.stop();var r={singleCardValue:a.CardList[a.backIndex(e)],unqiueCardValue:a.anwserCardType,remainingTime:Math.floor(a.nowTime/1e3),currentScore:a.score.text,isExistGame:0};return egret.Tween.get(a.dragGroup).to({x:a.cardPosition[e].x,y:a.cardPosition[e].y},500,egret.Ease.quadIn).call(function(){i.sendAnser(r)}),egret.Tween.get(a.dragCardBg).to({x:a.cardPosition[e].x,y:a.cardPosition[e].y},500,egret.Ease.quadIn),egret.Tween.get(a.dragCardLinght).to({x:a.cardPosition[e].x-7,y:a.cardPosition[e].y-7},500,egret.Ease.quadIn),"break"}},a=this;for(var s in this.cardPosition){var h=r(s);if("break"===h)break}t||(egret.Tween.get(this.dragGroup).to({x:this.cardPosition.answer.x,y:this.cardPosition.answer.y},100,egret.Ease.backOut),egret.Tween.get(this.dragCardBg).to({x:this.cardPosition.answer.x,y:this.cardPosition.answer.y},100,egret.Ease.backOut),egret.Tween.get(this.dragCardLinght).to({x:this.cardPosition.answer.x,y:this.cardPosition.answer.y},100,egret.Ease.backOut))},t.prototype.backIndex=function(e){var t;switch(e){case"one":t=0;break;case"two":t=1;break;case"three":t=2;break;case"four":t=3}return t},t.prototype.dragRemoveevent=function(){this.dragGroup.removeEventListener(egret.TouchEvent.TOUCH_BEGIN,this.OntouchBegin,this),this.dragGroup.removeEventListener(egret.TouchEvent.TOUCH_END,this.Ontouchend,this)},t.prototype.stepdragObjectInit=function(){this.stage.stageWidth,this.stage.stageHeight;this.stepdragCardLinght=new egret.Shape,this.stepdragCardLinght.graphics.beginFill(11913514,1),this.stepdragCardLinght.graphics.drawRoundRect(0,0,167,286,10,10),this.stepdragCardLinght.graphics.endFill(),this.stepdragCardLinght.x=this.cardPosition.answer.x-7,this.stepdragCardLinght.y=this.cardPosition.answer.y-7,this.stepdragCardLinght.alpha=0;var e=new egret.BlurFilter(3,3);this.stepdragCardLinght.filters=[e],this.stepdragCardBg=this.createCardBg("answer"),this.stepdragGroup=this.createCard("AAA","answer"),this.stepdragGroup.touchEnabled=!0,this.stepdragGroup.alpha=0,this.stepFourCardBg.alpha=0,this.addChild(this.stepdragCardLinght),this.addChild(this.stepdragCardBg),this.addChild(this.stepdragGroup),egret.Tween.get(this.stepdragCardBg).to({alpha:1},500,egret.Ease.backOut),egret.Tween.get(this.stepdragGroup).to({alpha:1},500,egret.Ease.backOut)},t.prototype.guitTouchHandles=function(){this.stepdragGroup.addEventListener(egret.TouchEvent.TOUCH_BEGIN,this.guitTouchstart,this),this.stage.addEventListener(egret.TouchEvent.TOUCH_END,this.guitTouchend,this)},t.prototype.guitTouchstart=function(e){this.isTouch=!0,this.startX=this.stepdragGroup.x,this.startY=this.stepdragGroup.y,this.XTouch=e.stageX,this.YTouch=e.stageY,this.stage.addEventListener(egret.TouchEvent.TOUCH_MOVE,this.guitTouchmove,this),egret.Tween.get(this.stetFourArrow).to({alpha:0},300,egret.Ease.backOut)},t.prototype.guitTouchmove=function(e){if(1==this.isTouch){this.stepdragCardLinght.x=this.startX+(e.stageX-this.XTouch)-7,this.stepdragCardLinght.y=this.startY+(e.stageY-this.YTouch)-7,this.stepdragCardBg.x=this.startX+(e.stageX-this.XTouch),this.stepdragCardBg.y=this.startY+(e.stageY-this.YTouch),this.stepdragGroup.x=this.startX+(e.stageX-this.XTouch),this.stepdragGroup.y=this.startY+(e.stageY-this.YTouch);var t=!1;this.stephitTest(this.cardPosition.one)&&(t=!0,this.stepFourBorder.x=this.cardPosition.one.x-4,this.stepFourBorder.y=this.cardPosition.one.y-4,this.stepFourBorder.alpha=1),t||(this.stepFourBorder.alpha=0)}},t.prototype.guitTouchend=function(e){this.isTouch=!1,this.stage.removeEventListener(egret.TouchEvent.TOUCH_MOVE,this.guitTouchmove,this);var t=!1,i=this;this.stephitTest(this.cardPosition.one)&&(this.stepdragGroup.removeEventListener(egret.TouchEvent.TOUCH_BEGIN,this.guitTouchstart,this),this.stage.removeEventListener(egret.TouchEvent.TOUCH_END,this.guitTouchend,this),t=!0,egret.Tween.get(i.stepdragGroup).to({x:i.cardPosition.one.x,y:i.cardPosition.one.y},500,egret.Ease.quadIn),egret.Tween.get(i.stepdragCardBg).to({x:i.cardPosition.one.x,y:i.cardPosition.one.y},500,egret.Ease.quadIn),egret.Tween.get(i.stepdragCardLinght).to({x:i.cardPosition.one.x-7,y:i.cardPosition.one.y-7},500,egret.Ease.quadIn).call(function(){egret.Tween.get(i.stepdragCardLinght).to({alpha:1},500,egret.Ease.backOut).wait(300).call(function(){i.guitScore.text=44,i.removeChild(i.png34),i.score.alpha=1,i.score.text="44",i.scroeAdd(10),egret.Tween.get(i.stepdragCardBg).to({y:-300},500,egret.Ease.backOut).call(function(){}),egret.Tween.get(i.stepdragCardLinght).to({y:-300},500,egret.Ease.backOut).call(function(){}),egret.Tween.get(i.stepdragGroup).to({y:-300},500,egret.Ease.backOut).call(function(){i.removeChild(i.stepdragGroup),i.removeChild(i.stepdragCardLinght),i.removeChild(i.stepdragCardBg),egret.Tween.get(i.stepFourText).to({alpha:0},500,egret.Ease.backOut).call(function(){}),egret.Tween.get(i.stetFourArrow).to({alpha:0},500,egret.Ease.backOut).call(function(){}),egret.Tween.get(i.stepFourBorder).to({alpha:0},500,egret.Ease.backOut).call(function(){}),egret.Tween.get(i.stepFourCardBg).to({alpha:0},500,egret.Ease.backOut).call(function(){}),egret.Tween.get(i.stepFourCard).to({alpha:0},500,egret.Ease.backOut).call(function(){i.removeChild(i.guiBG),i.removeChild(i.guitScore),i.stepFive()})}),egret.Tween.get(i.stepdragCardBg).to({y:-300},500,egret.Ease.backOut).call(function(){})})})),t||(egret.Tween.get(this.stetFourArrow).to({alpha:1},300,egret.Ease.backOut),egret.Tween.get(this.stepdragGroup).to({x:this.cardPosition.answer.x,y:this.cardPosition.answer.y},100,egret.Ease.backOut),egret.Tween.get(this.stepdragCardBg).to({x:this.cardPosition.answer.x,y:this.cardPosition.answer.y},100,egret.Ease.backOut),egret.Tween.get(this.stepdragCardLinght).to({x:this.cardPosition.answer.x-7,y:this.cardPosition.answer.y-7},100,egret.Ease.backOut))},t.prototype.hitTest=function(e){var t,i;t=this.dragGroup.x>=e.x?e.x+e.width-this.dragGroup.x:this.dragGroup.x+this.dragGroup.width-e.x,i=this.dragGroup.y>=e.y?e.y+e.height-this.dragGroup.y:this.dragGroup.y+this.dragGroup.height-e.y;var r=t*i;return t>0&&r>0&&r>this.dragGroup.width*this.dragGroup.height*.5},t.prototype.stephitTest=function(e){var t,i;t=this.stepdragGroup.x>=e.x?e.x+e.width-this.stepdragGroup.x:this.stepdragGroup.x+this.stepdragGroup.width-e.x,i=this.stepdragGroup.y>=e.y?e.y+e.height-this.stepdragGroup.y:this.stepdragGroup.y+this.stepdragGroup.height-e.y;var r=t*i;return t>0&&r>0&&r>this.stepdragGroup.width*this.stepdragGroup.height*.5},t.prototype.successCard=function(){var e=this;egret.Tween.get(this.dragCardLinght).to({alpha:1},500,egret.Ease.quadIn).wait(300).call(function(){egret.Tween.get(e.dragGroup).to({y:-300},500,egret.Ease.backOut),egret.Tween.get(e.dragCardBg).to({y:-300},500,egret.Ease.backOut),egret.Tween.get(e.dragCardLinght).to({y:-300},500,egret.Ease.backOut).call(function(){e.dragObjectInit(e.anwserCardType),e.touchHandles(),e.startTimer=e.timer(e.limitTime,e.circle),e.startTimer.start()})})},t.prototype.errorCard=function(){console.log(this.dragCardBg);var e=new egret.Timer(500,2);e.addEventListener(egret.TimerEvent.TIMER,this.changeIndexByTimer,this),e.addEventListener(egret.TimerEvent.TIMER_COMPLETE,this.changeIndexByTimerEnd,this),e.start()},t.prototype.changeIndexByTimer=function(){this.dragCardBg.selectedIndex=0==this.dragCardBg.selectedIndex?1:0},t.prototype.changeIndexByTimerEnd=function(){var e=this;egret.Tween.get(this.dragGroup).to({y:1500},1e3,egret.Ease.backInOut),egret.Tween.get(this.dragCardBg).to({y:1500},1e3,egret.Ease.backInOut),egret.Tween.get(this.dragCardLinght).to({y:1500},1e3,egret.Ease.bounceInOut).call(function(){e.removeDargCard(),e.dragObjectInit(e.anwserCardType),e.touchHandles(),e.startTimer=e.timer(e.limitTime,e.circle),e.startTimer.start()})},t.prototype.removeDargCard=function(){this.removeChild(this.dragCardLinght),this.removeChild(this.dragCardBg),this.removeChild(this.dragGroup)},t.prototype.createCard=function(e,t){var i,r=/\wA\w/,a=/\wB\w/,s=/\wC\w/;i=r.test(e)?this.createBitmapByName("redCards_json."+e):a.test(e)?this.createBitmapByName("yellowCards_json."+e):s.test(e)?this.createBitmapByName("blueCards_json."+e):this.createBitmapByName("greenCards_json."+e),i.x=this.cardPosition[t].x,i.y=this.cardPosition[t].y,i.width=this.cardPosition[t].width,i.height=this.cardPosition[t].height;new egret.DropShadowFilter(40,60,0,.8,16,16,.6,1,!1,!1);return this.addChild(i),i},t.prototype.createCardBg=function(e){var t;return t=this.createBitmapByName("cardBg_jpg"),t.x=this.cardPosition[e].x,t.y=this.cardPosition[e].y,t.width=this.cardPosition[e].width,t.height=this.cardPosition[e].height,this.addChild(t),t},t.prototype.CreateHelpBtn=function(){var e=this.createBitmapByName("icon-help_png");return e.width=46,e.height=46,e.x=30,e.y=1238,e.touchEnabled=!0,e.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onButtonClick,this),this.helpBtn=e,this.addChild(e),e},t.prototype.drawImage=function(){var e=new egret.RenderTexture;e.drawToTexture(this.stage)},t.prototype.BigBgShow=function(){window.document.getElementById("cover").style.display="block"},t.prototype.BigBgHide=function(){window.document.getElementById("cover").style.display="none"},t.prototype.steps=function(){console.log("step1");var e=this,t=new egret.Shape;t.graphics.beginFill(0,.75),t.graphics.drawRect(0,0,750,1334),t.graphics.endFill(),t.graphics.beginFill(16777215,1),this.shadowBg=t,this.addChild(t),this.BigBgShow();var i=new egret.TextField;i.y=54,i.text="0123456789",i.size=40,i.width=720,i.textAlign=egret.HorizontalAlign.RIGHT,i.fontFamily="MyText",i.alpha=0,this.addChild(i);var r=new egret.TextField;r.text="正确快速地匹配卡片来获得分数",r.textColor=16777215,r.width=350,r.textAlign=egret.HorizontalAlign.JUSTIFY,r.size=48,r.lineSpacing=30,r.x=209,r.y=449,r.alpha=0,this.addChild(r),egret.Tween.get(r).wait(500).to({y:429,alpha:1},500,egret.Ease.backOut);var a=new egret.Shape;a.graphics.beginFill(51584,1),a.graphics.drawRect(0,0,320,110),a.graphics.endFill(),a.x=215,a.y=1164,a.touchEnabled=!0,a.alpha=0,this.addChild(a),egret.Tween.get(a).wait(500).to({y:1144,alpha:1},500,egret.Ease.backOut);var s=new egret.TextField;s.text="我知道了",s.textColor=16777215,s.textAlign=egret.HorizontalAlign.CENTER,s.size=40,s.width=this.stage.width,s.lineSpacing=30,s.x=0,s.y=1200,s.alpha=0,this.addChild(s),egret.Tween.get(s).wait(500).to({y:1180,alpha:1},500,egret.Ease.backOut);var h=!1;a.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){console.log(h,"one"),h||(h=!0,a.touchEnabled=!1,egret.Tween.get(r).to({y:439,alpha:0},500,egret.Ease.backOut).call(function(){e.removeChild(r)}),egret.Tween.get(a).to({y:1145,alpha:0},500,egret.Ease.backOut).call(function(){e.removeChild(a)}),egret.Tween.get(s).to({y:1190,alpha:0},500,egret.Ease.backOut).call(function(){e.removeChild(s),e.stepThree()}))},this)},t.prototype.stepTwo=function(){var e=this,t=this.createBitmapByName("icon_arrow_right_png");t.width=97,t.height=67,t.x=607,t.y=130,t.alpha=0,this.addChild(t),egret.Tween.get(t).to({y:120,alpha:1},500,egret.Ease.backOut);var i=new egret.TextField;i.text="你的分数在这里           做的越快，分数越多～",i.textColor=16777215,i.textAlign=egret.HorizontalAlign.LEFT,i.size=36,i.lineSpacing=10,i.width=360,i.x=338,i.alpha=0,i.y=189,this.addChild(i),this.score.text="34",egret.Tween.get(i).to({y:169,alpha:1},500,egret.Ease.backOut);var r=new egret.Shape;r.graphics.beginFill(2716813,1),r.graphics.drawRect(0,0,90,70),r.graphics.endFill(),r.x=644,r.y=38,this.addChild(r);var a=new egret.Shape;a.graphics.beginFill(51584,1),a.graphics.drawRect(0,0,320,110),a.graphics.endFill(),a.x=215,a.y=1144,a.touchEnabled=!0,this.addChild(a);var s=new egret.TextField;s.text="我知道了",s.textColor=16777215,s.textAlign=egret.HorizontalAlign.CENTER,s.size=40,s.width=this.stage.width,s.lineSpacing=30,s.x=0,s.y=1180,this.addChild(s);var h=new egret.TextField;h.y=54,h.text="34",h.size=40,h.width=720,h.textAlign=egret.HorizontalAlign.RIGHT,h.fontFamily="MyText",this.addChild(h),a.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){a.touchEnabled&&(console.log("two"),a.touchEnabled=!1,this.removeChild(r),egret.Tween.get(i).to({y:189,alpha:0},500,egret.Ease.backOut).call(function(){e.removeChild(i)}),egret.Tween.get(h).to({y:64,alpha:0},500,egret.Ease.backOut),egret.Tween.get(t).to({y:130,alpha:0},500,egret.Ease.backOut).call(function(){e.removeChild(t)}),egret.Tween.get(a).to({y:1145,alpha:0},500,egret.Ease.backOut).call(function(){e.removeChild(a)}),egret.Tween.get(s).to({y:1190,alpha:0},500,egret.Ease.backOut).call(function(){e.removeChild(s),e.removeChild(h),e.stepFour()}))},this)},t.prototype.stepThree=function(){var e=this,t=this.createBitmapByName("icon_arrow_left_png");t.width=97,t.height=67,t.x=42,t.y=136,t.alpha=0,this.addChild(t),egret.Tween.get(t).to({y:116,alpha:1},500,egret.Ease.backOut);var i=new egret.TextField;i.text="每轮有30秒的时间",i.textColor=16777215,i.textAlign=egret.HorizontalAlign.LEFT,i.size=36,i.width=590,i.x=160,i.alpha=0,i.y=184,this.addChild(i);
var r=new egret.Shape;r.graphics.beginFill(2716813,1),r.graphics.drawRect(0,0,70,70),r.graphics.endFill(),r.x=18,r.y=38,this.addChild(r),egret.Tween.get(i).to({y:164,alpha:1},500,egret.Ease.backOut);var a=new egret.Shape;a.graphics.beginFill(16777215,.3),a.graphics.drawArc(53,73,23,0,2*Math.PI,!1),a.graphics.endFill(),this.addChild(a);var s=new egret.Shape,h=this.timer(1e4,s);h.start(),h.removeEventListener(egret.TimerEvent.TIMER_COMPLETE,e.endTime,this);var n=new egret.Shape;n.graphics.beginFill(51584,1),n.graphics.drawRect(0,0,320,110),n.graphics.endFill(),n.x=215,n.y=1164,n.touchEnabled=!0,n.alpha=0,this.addChild(n),egret.Tween.get(n).to({y:1144,alpha:1},500,egret.Ease.backOut);var o=new egret.TextField;o.text="我知道了",o.textColor=16777215,o.textAlign=egret.HorizontalAlign.CENTER,o.size=40,o.width=this.stage.width,o.lineSpacing=30,o.x=0,o.y=1200,o.alpha=0,this.addChild(o),egret.Tween.get(o).to({y:1180,alpha:1},500,egret.Ease.backOut),n.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){n.touchEnabled&&(console.log("three"),n.touchEnabled=!1,this.removeChild(r),egret.Tween.get(i).to({y:184,alpha:0},500,egret.Ease.backOut).call(function(){e.removeChild(i)}),egret.Tween.get(t).to({y:136,alpha:0},500,egret.Ease.backOut).call(function(){e.removeChild(t)}),egret.Tween.get(n).to({y:1145,alpha:0},500,egret.Ease.backOut).call(function(){e.removeChild(n)}),egret.Tween.get(o).to({y:1190,alpha:0},500,egret.Ease.backOut).call(function(){e.removeChild(o),e.stepTwo()}),h.stop(),a.graphics.clear(),s.graphics.clear(),e.removeChild(a),e.removeChild(s),h=null)},this)},t.prototype.stepFour=function(){this.guiBG=new egret.Shape,this.guiBG.graphics.beginFill(2716813,1),this.guiBG.graphics.drawRect(0,0,90,70),this.guiBG.graphics.endFill(),this.guiBG.x=644,this.guiBG.y=38,this.addChild(this.guiBG),this.guitScore=new egret.TextField,this.guitScore.y=54,this.guitScore.text="34",this.guitScore.size=40,this.guitScore.width=720,this.guitScore.textAlign=egret.HorizontalAlign.RIGHT,this.guitScore.fontFamily="MyText",this.addChild(this.guitScore),this.stepFourText=new egret.TextField,this.stepFourText.text="把下面的卡片拖到上面来匹配",this.stepFourText.textColor=16777215,this.stepFourText.textAlign=egret.HorizontalAlign.CENTER,this.stepFourText.size=36,this.stepFourText.width=750,this.stepFourText.x=0,this.stepFourText.alpha=0,this.stepFourText.y=181,this.addChild(this.stepFourText),egret.Tween.get(this.stepFourText).to({y:161,alpha:1},500,egret.Ease.backOut),this.stepFourBorder=new egret.Shape,this.stepFourBorder.graphics.beginFill(16777215,1),this.stepFourBorder.graphics.drawRect(0,0,this.cardPosition.one.width+8,this.cardPosition.one.height+8),this.stepFourBorder.graphics.endFill(),this.stepFourBorder.alpha=0,this.stepFourBorder.x=this.cardPosition.one.x-4,this.stepFourBorder.y=this.cardPosition.one.y-4;new egret.BlurFilter(3,3);this.addChild(this.stepFourBorder),this.stepFourCardBg=this.createCardBg("one"),this.stepFourCard=this.createCard("AAA","one"),this.stepFourCardBg.alpha=0,this.stepFourCard.alpha=0,egret.Tween.get(this.stepFourCardBg).to({alpha:1},500,egret.Ease.backOut),egret.Tween.get(this.stepFourCard).to({alpha:1},500,egret.Ease.backOut),this.dragGroup.alpha=0;var e=new egret.DropShadowFilter(0,0,11913514,.8,16,16,.6,1,!1,!1);this.stepFourCard.filters=[e],this.dragCardBg.alpha=0,this.stetFourArrow=this.createBitmapByName("arrow_move_png"),this.stetFourArrow.width=153,this.stetFourArrow.height=254,this.stetFourArrow.x=132,this.stetFourArrow.y=577,this.stetFourArrow.alpha=0,this.addChild(this.stetFourArrow),egret.Tween.get(this.stetFourArrow).to({alpha:1},800,egret.Ease.backOut),this.stepdragObjectInit(),this.stepdragCardLinght.alpha=0,this.guitTouchHandles()},t.prototype.stepFive=function(){var e=this;this.dragGroup.alpha=1,this.dragCardBg.alpha=1;var t=new egret.TextField;t.text="如果选错了的话,",t.textColor=16777215,t.textAlign=egret.HorizontalAlign.CENTER,t.size=48,t.width=750,t.x=0,t.alpha=0,t.y=439,this.addChild(t);var i=new egret.TextField;i.text="只要把下一张选对就好啦！",i.textColor=16777215,i.textAlign=egret.HorizontalAlign.CENTER,i.size=48,i.width=750,i.x=0,i.alpha=0,i.y=516,this.addChild(i),egret.Tween.get(t).to({y:429,alpha:1},500,egret.Ease.backOut),egret.Tween.get(i).to({y:506,alpha:1},500,egret.Ease.backOut);var r=new egret.Shape;r.graphics.beginFill(51584,1),r.graphics.drawRect(0,0,320,110),r.graphics.endFill(),r.x=215,r.y=1144,r.touchEnabled=!0,this.addChild(r);var a=new egret.TextField;a.text="我知道了",a.textColor=16777215,a.textAlign=egret.HorizontalAlign.CENTER,a.size=40,a.width=this.stage.width,a.lineSpacing=30,a.x=0,a.y=1180,this.addChild(a),r.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){r.touchEnabled&&(r.touchEnabled=!1,egret.Tween.get(r).to({y:1145,alpha:0},500,egret.Ease.backOut).call(function(){e.removeChild(r)}),egret.Tween.get(t).to({y:439,alpha:0},500,egret.Ease.backOut).call(function(){e.removeChild(t)}),egret.Tween.get(i).to({y:516,alpha:0},500,egret.Ease.backOut).call(function(){e.removeChild(i)}),egret.Tween.get(a).to({y:1190,alpha:0},500,egret.Ease.backOut).call(function(){e.removeChild(a),e.stepSix()}))},this)},t.prototype.stepSix=function(){var e=this,t=new egret.TextField;t.text="准备好了的话，就点击",t.textColor=16777215,t.textAlign=egret.HorizontalAlign.CENTER,t.size=48,t.width=750,t.x=0,t.alpha=0,t.y=439,this.addChild(t);var i=new egret.TextField;i.text="屏幕开始回答吧!",i.textColor=16777215,i.textAlign=egret.HorizontalAlign.CENTER,i.size=48,i.width=750,i.x=0,i.alpha=0,i.y=516,this.addChild(i),egret.Tween.get(t).to({y:429,alpha:1},500,egret.Ease.backOut),egret.Tween.get(i).to({y:506,alpha:1},500,egret.Ease.backOut);var r=new egret.Shape;r.graphics.beginFill(51584,1),r.graphics.drawRect(0,0,320,110),r.graphics.endFill(),r.x=215,r.y=910,r.touchEnabled=!0,this.addChild(r);var a=new egret.TextField;a.text="准备好了",a.textColor=16777215,a.textAlign=egret.HorizontalAlign.CENTER,a.size=40,a.width=this.stage.width,a.lineSpacing=30,a.x=0,a.y=946,this.addChild(a);var s=this.createBitmapByName("resst_png");s.x=358,s.y=1134,s.width=34,s.height=36,s.touchEnabled=!0,this.addChild(s);var h=new egret.TextField;h.text="再看一次",h.textColor=16777215,h.textAlign=egret.HorizontalAlign.CENTER,h.size=32,h.width=750,h.x=0,h.y=1206,this.addChild(h),s.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){s.touchEnabled&&(s.touchEnabled=!1,e.removeChild(t),e.removeChild(i),e.removeChild(h),e.removeChild(s),e.removeChild(r),e.removeChild(a),e.removeChild(this.shadowBg),e.steps())},this),r.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){r.touchEnabled&&(r.touchEnabled=!1,e.removeChild(t),e.removeChild(i),e.removeChild(h),e.removeChild(s),e.removeChild(r),e.removeChild(a),e.BigBgHide(),e.removeChild(this.shadowBg),e.GameInit())},this)},t.prototype.GameInit=function(){this.clearCard();this.Http("POST",this.root+"WcstGame/startGame.do",{},function(e){var t=e.currentTarget,i=JSON.parse(t.response);if(console.log(i),0==i.status){var r=i.singleCardValue.split(",");this.CardList=r,this.version=i.gameVersion,this.complateUrl=i.questionnaireLink,this.anwserCardType=i.unqiueCardValue,this.CreateSelectCard(r),this.dragObjectInit(i.unqiueCardValue),this.touchHandles(),this.limitTime=1e3*i.gameTime,this.startTimer=this.timer(this.limitTime,this.circle,this.endTime),this.startTimer.start(),this.score.text=i.currentScore}else alert(i.message);console.log("post data : ",JSON.parse(t.response))},function(){})},t.prototype.sendAnser=function(e){var t=this;this.Http("POST",this.root+"WcstGame/getNextGameAndSubmitResult.do",e,function(e){var i=e.currentTarget,r=JSON.parse(i.response);console.log(r),0==r.status?0==r.gameStatus?0==r.result?(t.anwserCardType=r.unqiueCardValue,t.scroeAdd(r.currentScore-this.score.text),t.score.text=r.currentScore,t.successCard()):(t.anwserCardType=r.unqiueCardValue,t.score.text=r.currentScore,t.errorCard()):t.GameComplate():(alert(r.message),t.steps()),console.log("post data : ",JSON.parse(i.response))},function(){})},t.prototype.scroeAdd=function(e){var t=this;if(0!==e){var i=new eui.Label;i.text="+"+e,i.textColor=16777215,i.size=20,i.width=720,i.x=0,i.y=100,i.textAlign="right",i.fontFamily="MyText",i.alpha=0,this.addChild(i),egret.Tween.get(i).to({y:96,alpha:1},500,egret.Ease.backInOut).wait(500).to({y:90,alpha:0},500,egret.Ease.backInOut).call(function(){t.removeChild(i)})}},t.prototype.GameComplate=function(){this.BigBgShow();var e=this,t=new egret.RenderTexture;this.helpBtn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onButtonClick,this);var i=new egret.Shape;i.graphics.beginFill(0,.75),i.graphics.drawRect(0,0,750,1334),i.graphics.endFill(),this.shadowBg=i,this.addChild(i);var r=new eui.Label;r.text="你的得分",r.textColor=16777215,r.textAlign="center",r.size=36,r.width=750,r.x=0,r.y=323,this.addChild(r);var a=new egret.Shape;a.graphics.beginFill(12697536,1),a.graphics.drawRect(0,0,42,4),a.graphics.endFill(),a.x=354,a.y=406,this.addChild(a);var s=new eui.Label;s.textColor=16275789,s.textAlign="center",s.text=this.score.text,s.fontFamily="MyText",s.width=750,s.size=160,s.y=520,s.alpha=0,this.addChild(s),egret.Tween.get(s).to({y:480,alpha:1},1e3,egret.Ease.quadIn).call(function(){if(t.drawToTexture(e.stage),0==e.version){var i=new eui.Group;i.width=450,i.height=100,i.x=150,i.y=1030,i.touchEnabled=!0;var r=new egret.Shape;r.graphics.beginFill(51584,1),r.graphics.drawRect(0,0,450,100),r.graphics.endFill();var a=new eui.Label;a.text="回答问卷帮我们改进",a.textColor=16777215,a.textAlign="center",a.size=40,a.width=450,a.height=100,a.verticalAlign="middle",i.addChild(r),i.addChild(a),e.addChild(i),i.alpha=0,egret.Tween.get(i).to({alpha:1},500,egret.Ease.quadIn),i.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){if(0==e.version)window.location.href=e.complateUrl;else{var i=t.toDataURL("image/png",new egret.Rectangle(0,0,e.stage.width,e.stage.height)),r=window.document.getElementById("downloadImg");r.src&&(r.src=i),window.document.getElementById("downloadImg").style.display="block"}},this)}else{var s=e.createBitmapByName("finger_png");s.width=100,s.height=100,s.x=325,s.y=971,e.addChild(s),s.alpha=0,egret.Tween.get(s).to({alpha:1},500,egret.Ease.quadIn);var h=new eui.Label;h.text="长按此保存图片分享你的分数",h.width=236,h.textAlign="center",h.textColor=16777215,h.size=32,h.lineSpacing=30,h.y=1118,h.x=264,e.addChild(h),egret.Tween.get(h).to({alpha:1},500,egret.Ease.quadIn);var n=t.toDataURL("image/png",new egret.Rectangle(0,0,e.stage.width,e.stage.height)),o=window.document.getElementById("downloadImg");o.src&&(o.src=n),window.document.getElementById("downloadImg").style.display="block"}})},t.prototype.download=function(e){var t=e;this.downloadFile("测试.png",t)},t.prototype.downloadFile=function(e,t){var i=document.createElement("a"),r=this.base64ToBlob(t),a=document.createEvent("HTMLEvents");a.initEvent("click",!0,!0),i.download=e,i.href=URL.createObjectURL(r),i.dispatchEvent(new MouseEvent("click",{bubbles:!0,cancelable:!0,view:window}))},t.prototype.base64ToBlob=function(e){for(var t=e.split(";base64,"),i=t[0].split(":")[1],r=window.atob(t[1]),a=r.length,s=new Uint8Array(a),h=0;a>h;++h)s[h]=r.charCodeAt(h);return new Blob([s],{type:i})},t.prototype.clearCard=function(){this.score.text="0",egret.Tween.get(this.cardBg1).to({y:this.cardPosition.one.y+10,alpha:0},300,egret.Ease.backOut),egret.Tween.get(this.cardBg2).to({y:this.cardPosition.two.y+10,alpha:0},300,egret.Ease.backOut),egret.Tween.get(this.cardBg3).to({y:this.cardPosition.three.y+10,alpha:0},300,egret.Ease.backOut),egret.Tween.get(this.cardBg4).to({y:this.cardPosition.four.y+10,alpha:0},300,egret.Ease.backOut),egret.Tween.get(this.Card1).to({y:this.cardPosition.one.y+10,alpha:0},300,egret.Ease.backOut),egret.Tween.get(this.Card2).to({y:this.cardPosition.two.y+10,alpha:0},300,egret.Ease.backOut),egret.Tween.get(this.Card3).to({y:this.cardPosition.three.y+10,alpha:0},300,egret.Ease.backOut),egret.Tween.get(this.Card4).to({y:this.cardPosition.four.y+10,alpha:0},300,egret.Ease.backOut),egret.Tween.get(this.dragGroup).to({y:this.cardPosition.answer.y+10,alpha:0},300,egret.Ease.backOut),egret.Tween.get(this.dragCardBg).to({y:this.cardPosition.answer.y+10,alpha:0},300,egret.Ease.backOut)},t.prototype.CreateSelectCard=function(e){this.cardBg1=this.createCardBg("one"),this.cardBg1.alpha=0,egret.Tween.get(this.cardBg1).to({alpha:1},800,egret.Ease.backOut),this.cardBg2=this.createCardBg("two"),this.cardBg2.alpha=0,egret.Tween.get(this.cardBg2).to({alpha:1},800,egret.Ease.backOut),this.cardBg3=this.createCardBg("three"),this.cardBg3.alpha=0,egret.Tween.get(this.cardBg3).to({alpha:1},800,egret.Ease.backOut),this.cardBg4=this.createCardBg("four"),this.cardBg4.alpha=0,egret.Tween.get(this.cardBg4).to({alpha:1},800,egret.Ease.backOut),this.Card1=this.createCard(e[0],"one"),this.Card1.alpha=0,egret.Tween.get(this.Card1).to({alpha:1},800,egret.Ease.backOut),this.Card2=this.createCard(e[1],"two"),this.Card2.alpha=0,egret.Tween.get(this.Card2).to({alpha:1},800,egret.Ease.backOut),this.Card3=this.createCard(e[2],"three"),this.Card3.alpha=0,egret.Tween.get(this.Card3).to({alpha:1},800,egret.Ease.backOut),this.Card4=this.createCard(e[3],"four"),this.Card4.alpha=0,egret.Tween.get(this.Card4).to({alpha:1},800,egret.Ease.backOut)},t.prototype.Http=function(e,t,i,r,a){var s=new egret.HttpRequest;s.responseType=egret.HttpResponseType.TEXT;var h="GET"==e?egret.HttpMethod.GET:egret.HttpMethod.POST,n="";if("GET"==e){n="?";for(var o in i)n+=o+"="+i[o]+"&";n=n.replace(/&$/,""),s.open(t+n,h),s.setRequestHeader("Content-Type","application/x-www-form-urlencoded;charset=UTF-8"),s.send()}else{for(var o in i)n+=o+"="+i[o]+"&";n=n.replace(/&$/,""),s.open(t,h),s.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),s.withCredentials=!0,s.send(n)}return s.addEventListener(egret.Event.COMPLETE,r,this),s.addEventListener(egret.IOErrorEvent.IO_ERROR,a,this),s},t}(eui.UILayer);__reflect(Main.prototype,"Main");var DebugPlatform=function(){function e(){}return e.prototype.getUserInfo=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(e){return[2,{nickName:"username"}]})})},e.prototype.login=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(e){return[2]})})},e}();__reflect(DebugPlatform.prototype,"DebugPlatform",["Platform"]),window.platform||(window.platform=new DebugPlatform);var SceneManager=function(){function e(){}return e.getInstance=function(){return null===this._manager&&(this._manager=new e),this._manager},e.prototype.goScene=function(e){this.currentScene&&(this.rootScene.removeChild(this.currentScene),this.currentScene=null),this.rootScene.addChild(e),this.currentScene=e},e._manager=null,e}();__reflect(SceneManager.prototype,"SceneManager");var ThemeAdapter=function(){function e(){}return e.prototype.getTheme=function(e,t,i,r){function a(e){t.call(r,e)}function s(t){t.resItem.url==e&&(RES.removeEventListener(RES.ResourceEvent.ITEM_LOAD_ERROR,s,null),i.call(r))}var h=this;if("undefined"!=typeof generateEUI)egret.callLater(function(){t.call(r,generateEUI)},this);else if("undefined"!=typeof generateEUI2)RES.getResByUrl("resource/gameEui.json",function(e,i){window.JSONParseClass.setData(e),egret.callLater(function(){t.call(r,generateEUI2)},h)},this,RES.ResourceItem.TYPE_JSON);else if("undefined"!=typeof generateJSON)if(e.indexOf(".exml")>-1){var n=e.split("/");n.pop();var o=n.join("/")+"_EUI.json";generateJSON.paths[e]?egret.callLater(function(){t.call(r,generateJSON.paths[e])},this):RES.getResByUrl(o,function(i){window.JSONParseClass.setData(i),egret.callLater(function(){t.call(r,generateJSON.paths[e])},h)},this,RES.ResourceItem.TYPE_JSON)}else egret.callLater(function(){t.call(r,generateJSON)},this);else RES.addEventListener(RES.ResourceEvent.ITEM_LOAD_ERROR,s,null),RES.getResByUrl(e,a,this,RES.ResourceItem.TYPE_TEXT)},e}();__reflect(ThemeAdapter.prototype,"ThemeAdapter",["eui.IThemeAdapter"]);var FirstScene=function(e){function t(){var t=e.call(this)||this;return t.onComplete(),t.createView(),t}return __extends(t,e),t.prototype.onComplete=function(){console.log("完成")},t.prototype.createView=function(){this.bg=new egret.Shape,this.bg.graphics.beginFill(0,.75),this.bg.graphics.drawRect(0,0,750,1334),this.bg.graphics.endFill(),this.bg.graphics.beginFill(16777215,1),this.txt=new egret.TextField,this.txt.text="正确快速地匹配卡片来获得分数",this.txt.textColor=16777215,this.txt.width=333,this.txt.height=119,this.txt.textAlign=egret.HorizontalAlign.RIGHT,this.rootScene.addChild(this.bg)},t}(Scene);__reflect(FirstScene.prototype,"FirstScene");